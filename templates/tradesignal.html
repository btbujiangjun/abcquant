{% extends "base.html" %}

{% block content %}
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<link rel="stylesheet" href="/static/tradesignal.css">
<style>

:root {
  --accent: #38bdf8; --buy-color: #22c55e;
}

#matrixBody td {
    padding: 2px 2px;
    text-align: center;
    vertical-align: middle;
    line-height: 1.1;
    height: 24px;
    background: #fff;
}
#matrixBody .sticky-date {
    position: sticky;
    left: 0;
    z-index: 2;
    padding: 1px 6px;
    font-size: 12px;
    font-weight: 500;
    white-space: nowrap;
    background: #fff;
}



h3 { margin-top: 0; border-bottom: 1px solid #334155; padding-bottom: 10px; font-    size: 16px; color: var(--accent); }
.summary-container {
    display: flex;
    flex-direction: row;
    gap: 20px;
    padding: 5px;
    background-color: #f5f5f5;
    min-height: 200px;
}

.summary_bar {
    flex: 1;
    background-color: #ffffff;
    color: #333;
    padding: 5px;
    border-radius: 3px;
    border: 1px solid #ddd;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

@media (max-width: 600px) {
    .summary-container {
      flex-direction: column;
    }
}
.heatmap-container { display: grid; gap: 2px; margin-top: 10px; }
.heatmap-cell { height: 35px; border-radius: 2px; display: flex; align-items: center; justify-content: center; font-size: 10px; font-family: monospace; }
.pos-value { font-size: 36px; font-weight: 800; color: var(--buy-color); text-align: center; margin: 10px 0; }
.pos-desc { font-size: 16px; color: #94a3b8; text-align: center; }
.pos-value.text-pos {color: var(--buy-color);}
.pos-value.text-neg {color: #dc2626;}

/* ä¸‰åˆ—å¸ƒå±€ */
.section-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(31%, 1fr));
    gap: 10px; /* ç¼©å°é—´è·ä½¿æ•´ä½“æ›´ç´§å‡‘ */
    margin-bottom: 5px;
}
.section {
    background: white;
    border-radius: 6px; /* ç•¥å¾®å‡å°åœ†è§’æ›´æ˜¾å¹²ç»ƒ */
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    padding: 6px; /* å‹ç¼©å†…è¾¹è· */
}
/* é’ˆå¯¹æ‰‹æœºç«¯è‡ªåŠ¨é™çº§ä¸ºå•åˆ— */
@media (max-width: 768px) {
    .section-grid {
        grid-template-columns: 1fr;
    }
}


/* æ ¸å¿ƒå®¹å™¨ï¼šæ°´å¹³å¹¶æ’ */
.pos-header-grid {
    display: flex;
    justify-content: space-around;
    align-items: center;
    padding: 20px 10px;
    background: linear-gradient(to bottom, #ffffff, #f8fafc);
    border-radius: 8px;
    margin-bottom: 10px;
}

/* å‚ç›´åˆ†å‰²çº¿ */
.pos-divider {
    width: 1px;
    height: 60px;
    background: #e2e8f0;
}

/* æ ¸å¿ƒå—å¸ƒå±€ */
.pos-block {
    flex: 1;
    text-align: center;
}

.pos-label {
    font-size: 13px;
    color: #64748b;
    margin-bottom: 8px;
    font-weight: 500;
}

/* å¤§å°ºå¯¸æ•°å€¼ */
.pos-val-ops { font-size: 36px; font-weight: 900; line-height: 1; }
.pos-val-num { font-size: 38px; font-weight: 800; line-height: 1; }

/* å¼±åŒ–åçš„åº•éƒ¨æ•°æ®æ  */
.pos-footer-metrics {
    display: flex;
    justify-content: center;
    gap: 15px;
    padding: 10px 0;
    border-top: 1px dashed #e2e8f0;
    font-size: 12px;
    color: #94a3b8;
}

.pos-footer-metrics b { color: #475569; }

/* é¢œè‰²ç±» */
.text-buy { color: #22c55e; }
.text-sell { color: #dc2626; }

</style>
<h1>ğŸ²<span class="gradient-h1-title">äº¤æ˜“ä¿¡å·</span>ğŸ¯</h1>
<div class="toolbar">
  <label>é€‰æ‹©è‚¡ç¥¨</label>
  <select id="stockSelector"></select>
  <input type="text" id="stockSearch" placeholder="è¾“å…¥è‚¡ç¥¨ä»£ç æˆ–åç§°æœç´¢">
  <button onclick="loadData()">æŸ¥è¯¢</button>  
</div>
<div class="section-grid">
<div class="section">
  <div class="section-header"><h3><span class="gradient-title">å®æ—¶å¤´å¯¸å»ºè®®</span></h3></div>
  <table><tbody><tr><td>
    <div class="pos-header-grid">
        <div class="pos-block">
            <div class="pos-label">æ“ä½œå»ºè®®</div>
            <div id="kellyOps" class="pos-val-ops text-buy">NEUTRAL</div>
        </div>
        
        <div class="pos-divider"></div>
        
        <div class="pos-block">
            <div class="pos-label">å»ºè®®ä»“ä½</div>
            <div id="kellyPos" class="pos-val-num text-sell">0.0%</div>
        </div>
    </div>
    <div class="pos-footer-metrics">
      <span>å¾—åˆ†: <b id="kellyScore">-0.07</b></span>
      <span>|</span>
      <span>ç½®ä¿¡åº¦: <b id="kellyConfience">6.86%</b></span>
    </div>
    <div id="kellyAction" class="pos-status-hint">çŠ¶æ€ï¼šåˆ†æ­§æœŸã€‚å»ºè®®è§‚æœ›ã€‚</div>
      <canvas id="gaugeCanvas" width="260" height="120" style="opacity: 0.8;"></canvas>
    </div>
    <div id="dynamic_risk_management"></div>
    </td></tr></tbody></table>
  </div>
    
  <div class="section">
    <div class="section-header">
      <h3><span class="gradient-title">ç­–ç•¥æ‰“åˆ†</span></h3>      
    </div>
    <table>
      <thead><tr><th>åºå·</th><th>ç­–ç•¥å</th><th>æƒé‡å æ¯”</th><th>åŸå§‹æ‰“åˆ†</th></tr></thead>
      <tbody id="strategy_score"><tr><td colspan="3">æš‚æ— æ•°æ®</td></tr></tbody>
    </table>
  </div>
  <div class="section">
    <div class="section-header">
      <h3><span class="gradient-title">æƒé‡è·Ÿè¸ª</span></h3>
    </div>
    <table>
      <tbody id="strategy_analysis"><tr><td></td></tr></tbody>
    </table>
  </div>
</div>
<div class="dashboard-container">
  <div class="matrix-wrapper">
    <table id="matrixTable">
      <thead>
        <tr id="headerRow"><th rowspan="2" class="sticky-date">äº¤æ˜“æ—¥æœŸ</th></tr>
        <tr id="statsRow"></tr>
      </thead>
      <tbody id="matrixBody"></tbody>
    </table>
  </div>
</div>
<script src="/static/tradesignal.js"></script>
{% endblock %}
