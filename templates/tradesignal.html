{% extends "base.html" %}

{% block content %}
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<link rel="stylesheet" href="/static/tradesignal.css">
<style>
:root {
  --accent: #38bdf8; --buy-color: #22c55e;
}
#matrixBody td {
    padding: 2px 2px;
    text-align: center;
    vertical-align: middle;
    line-height: 1.1;
    height: 24px;
    background: #fff;
}
#matrixBody .sticky-date {
    position: sticky;
    left: 0;
    z-index: 2;
    padding: 1px 6px;
    font-size: 12px;
    font-weight: 500;
    white-space: nowrap;
    background: #fff;
}
h3 { margin-top: 0; border-bottom: 1px solid #334155; padding-bottom: 10px; font-size: 16px; color: var(--accent); }
@media (max-width: 600px) {
    .summary-container {
      flex-direction: column;
    }
}
.heatmap-container { display: grid; gap: 2px; margin-top: 10px; }
.heatmap-cell { height: 35px; border-radius: 2px; display: flex; align-items: center; justify-content: center; font-size: 10px; font-family: monospace; }
.pos-value { font-size: 36px; font-weight: 800; color: var(--buy-color); text-align: center; margin: 10px 0; }
.pos-desc { font-size: 16px; color: #94a3b8; text-align: center; }
.pos-value.text-pos {color: var(--buy-color);}
.pos-value.text-neg {color: #dc2626;}

.matrix-wrapper {
    width: 100%;
    overflow-x: auto;
    overflow-y: hidden;
}

.section-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(48%, 1fr));
    gap: 10px;
    margin-bottom: 5px;
}
.section {
    background: white;
    border-radius: 6px; /* ç•¥å¾®å‡å°åœ†è§’æ›´æ˜¾å¹²ç»ƒ */
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    padding: 6px; /* å‹ç¼©å†…è¾¹è· */
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
}
/* é’ˆå¯¹æ‰‹æœºç«¯è‡ªåŠ¨é™çº§ä¸ºå•åˆ— */
@media (max-width: 768px) {
    .section-grid {
        grid-template-columns: 1fr;
    }
}
/* æ ¸å¿ƒå®¹å™¨ï¼šæ°´å¹³å¹¶æ’ */
.pos-header-grid {
    display: flex;
    justify-content: space-around;
    align-items: center;
    padding: 20px 10px;
    background: linear-gradient(to bottom, #ffffff, #f8fafc);
    border-radius: 8px;
    margin-bottom: 10px;
}
/* å‚ç›´åˆ†å‰²çº¿ */
.pos-divider {
    width: 1px;
    height: 60px;
    background: #e2e8f0;
}
/* æ ¸å¿ƒå—å¸ƒå±€ */
.pos-block {
    flex: 1;
    text-align: center;
}

.pos-label {
    font-size: 13px;
    color: #64748b;
    margin-bottom: 8px;
    font-weight: 500;
}

/* å¤§å°ºå¯¸æ•°å€¼ */
.pos-val-ops { font-size: 28px; font-weight: 900; line-height: 1; }
.pos-val-num { font-size: 32px; font-weight: 800; line-height: 1; }

/* å¼±åŒ–åçš„åº•éƒ¨æ•°æ®æ  */
.pos-footer-metrics {
    display: flex;
    justify-content: center;
    gap: 15px;
    padding: 10px 0;
    border-top: 1px dashed #e2e8f0;
    font-size: 14px;
    color: #94a3b8;
}
#gaugeCanvas {
    display: block;   /* å¿…é¡»è½¬ä¸ºå—çº§ */
    margin: 0 auto;  /* æ°´å¹³å±…ä¸­ */
}
.pos-footer-metrics b { color: #4f46e5; }

.pos-status-hint {
    display: flex;
    justify-content: center;
    gap: 15px;
    padding: 10px 0;
    border-top: 1px dashed #e2e8f0;
    font-size: 14px;
    color: #0f172a;
}

.text-buy { color: #22c55e; }
.text-sell { color: #dc2626; }
a {
    color: #111827;
    text-decoration: none;
    transition: color 0.2s ease;
}
a:hover {
    color: var(--accent);
    text-decoration: none;
}
</style>
<h1>ğŸ²<span class="gradient-h1-title">äº¤æ˜“ä¿¡å·</span>ğŸ¯</h1>
<div class="toolbar">
  <label>é€‰æ‹©è‚¡ç¥¨</label>
  <select id="stockSelector"></select>
  <input type="text" id="stockSearch" placeholder="è¾“å…¥è‚¡ç¥¨ä»£ç æˆ–åç§°æœç´¢">
  <button onclick="loadData()">æŸ¥è¯¢</button>  
</div>
<div class="section-grid">
<div class="section">
  <div class="section-header"><h3><span class="gradient-title">å®æ—¶å¤´å¯¸å»ºè®®</span></h3></div>
    <div class="pos-header-grid">
        <div class="pos-block">
            <div class="pos-label">è‚¡ç¥¨ä»£ç </div>
            <div id="kellySymbol" class="pos-val-ops text-buy">NEUTRAL</div>
        </div>
        <div class="pos-divider"></div>
        <div class="pos-block">
            <div class="pos-label">æ“ä½œå»ºè®®</div>
            <div id="kellyOps" class="pos-val-ops text-buy">NEUTRAL</div>
        </div>
        <div class="pos-divider"></div>
        <div class="pos-block">
            <div class="pos-label">å»ºè®®ä»“ä½</div>
            <div id="kellyPos" class="pos-val-num text-sell">0.0%</div>
        </div>
    </div>
    <div class="pos-footer-metrics">
      <span>å¾—åˆ†: <b id="kellyScore">-0.07</b></span>
      <span>|</span>
      <span>ç½®ä¿¡åº¦: <b id="kellyConfience">6.86%</b></span>
    </div>
    <div id="kellyAction" class="pos-status-hint">çŠ¶æ€ï¼šåˆ†æ­§æœŸã€‚å»ºè®®è§‚æœ›ã€‚</div>
    <canvas id="gaugeCanvas" width="260" height="120" style="opacity: 0.8;"></canvas>
    <div id="kellyInterpretation" class="pos-status-hint">æç¤ºï¼šç³»ç»Ÿè¿è¡Œæ­£å¸¸ï¼Œä»“ä½ä¸ä¿¡å·å¼ºåº¦åŒ¹é…</div>
    <div id="dynamic_risk_management" class="pos-footer-metrics"></div>
  </div>
    
  <div class="section">
    <div class="section-header"><h3><span class="gradient-title">ç­–ç•¥æ‰“åˆ†</span></h3></div>
    <table>
      <thead><tr>
        <th>åºå·</th>
        <th>ç­–ç•¥</th>
        <th>æƒé‡</th>
        <th>å¹´åŒ–</th>
        <th>è°ƒæƒç¬”èƒœç‡</th>
        <th>äº¤æ˜“ç½®ä¿¡åº¦</th>
        <th>alpha</th>
        <th>å¡ç›</th>
        <th>risk</th>
        <th>è·åˆ©æ–¹å·®</th>
        <th>æœ€è¿‘è·åˆ©</th>
        <th>å®æ—¶æŸç›Š</th>
        <th>ç›¸å…³æ€§ç¨€é‡Š</th>
        <th>æ”¶ç›Šæ³¢åŠ¨ç‡</th>
        <th>åŠ æƒæœŸæœ›èƒœç‡</th>
        <th>åŠ æƒæœŸæœ›ç›ˆäºæ¯”</th>
        <th>åŸå§‹å‡¯åˆ©</th>
        <th>å¤šæ ·æ€§</th>
        <th>èåˆä¿¡å·</th>
        <th>ä¿¡å·ç½®ä¿¡åº¦</th>
        <th>å¢å¼ºå‡¯åˆ©</th>
        <th>é£é™©ç³»æ•°</th>
        <th>å‡¯åˆ©ä»“ä½</th>
        <th>ä¿æŠ¤ä»“ä½</th>
        <th>å½“å‰ä»“ä½</th>
        <th>æ“ä½œ</th>
      </tr></thead>
      <tbody id="strategy_score"><tr><td colspan="26">æš‚æ— æ•°æ®</td></tr></tbody>
    </table>
  </div>
</div>
<div class="dashboard-container">
  <div class="matrix-wrapper">
    <table id="matrixTable">
      <thead>
        <tr id="headerRow"><th rowspan="2" class="sticky-date">äº¤æ˜“æ—¥æœŸ</th><th rowspan="2" class="sticky-date">ä»·æ ¼</th></tr>
        <tr id="statsRow"></tr>
      </thead>
      <tbody id="matrixBody"></tbody>
    </table>
  </div>
</div>
<script src="/static/tradesignal.js"></script>
{% endblock %}
